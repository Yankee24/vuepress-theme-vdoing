(window.webpackJsonp=window.webpackJsonp||[]).push([[239],{741:function(a,s,t){"use strict";t.r(s);var n=t(21),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[a._v("文末附下载方式")])]),a._v(" "),t("h3",{attrs:{id:"_1-flink运行环境-local"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-flink运行环境-local"}},[a._v("#")]),a._v(" 1. Flink运行环境_Local")]),a._v(" "),t("h4",{attrs:{id:"_1-1-启动local环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-启动local环境"}},[a._v("#")]),a._v(" 1.1 启动Local环境")]),a._v(" "),t("h5",{attrs:{id:"_1-1-1-启动flink"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-启动flink"}},[a._v("#")]),a._v(" 1.1.1 启动Flink")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("bin/start-cluster.sh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/local-start.png",alt:""}})]),a._v(" "),t("h5",{attrs:{id:"_1-1-2-查看web-ui界面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-查看web-ui界面"}},[a._v("#")]),a._v(" 1.1.2 查看Web UI界面")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("http://虚拟机地址:8081\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/local-web.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"_1-2-命令行提交应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-命令行提交应用"}},[a._v("#")]),a._v(" 1.2 命令行提交应用")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("bin/flink run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-m hadoop01:8081 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-d "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Scala wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[a._v("注意：启动之前需要先启动hadoop01上的scoket（用的jar包是快速上手中的代码）")]),a._v(" "),t("ul",[t("li",[a._v("-m 表示JobManager所在节点")]),a._v(" "),t("li",[a._v("-d 表示提交后退出客户端")]),a._v(" "),t("li",[a._v("-c 全类名和jar包位置")])]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/submit-local.png",alt:""}})]),a._v(" "),t("p",[a._v("在浏览器中查看执行情况")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/stdout-local.png",alt:""}})]),a._v(" "),t("p",[a._v("在日志中查看执行结果")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" log/flink-hadoop-taskexecutor-1-hadoop01.out\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/cat-local.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"_1-3-web页面提交应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-web页面提交应用"}},[a._v("#")]),a._v(" 1.3 Web页面提交应用")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/web-submit.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/web-submit-config.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"_2-flink运行环境-standalone"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-flink运行环境-standalone"}},[a._v("#")]),a._v(" 2. Flink运行环境_Standalone")]),a._v(" "),t("p",[a._v("只使用Flink自身节点运行的集群模式，也就是我们所谓的（Standalone）模式，也叫做独立集群模式。")]),a._v(" "),t("h4",{attrs:{id:"_2-1-flink独立集群部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-flink独立集群部署"}},[a._v("#")]),a._v(" 2.1 Flink独立集群部署")]),a._v(" "),t("h5",{attrs:{id:"_2-1-1-解压缩文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-解压缩文件"}},[a._v("#")]),a._v(" 2.1.1 解压缩文件")]),a._v(" "),t("p",[a._v("将flink-1.12.2文件上传到指定目录并解压。")]),a._v(" "),t("h5",{attrs:{id:"_2-1-2-修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-修改配置文件"}},[a._v("#")]),a._v(" 2.1.2 修改配置文件")]),a._v(" "),t("p",[a._v("进入解压缩的路径的conf目录，修改flink-conf.yaml")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jobmanager.rpc.address: hadoop01\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h5",{attrs:{id:"_2-1-3-修改works文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-修改works文件"}},[a._v("#")]),a._v(" 2.1.3 修改works文件")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("hadoop01\nhadoop02\nhadoop03\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h5",{attrs:{id:"_2-1-4-将flink分发到集群的每台机器中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-4-将flink分发到集群的每台机器中"}},[a._v("#")]),a._v(" 2.1.4 将flink分发到集群的每台机器中")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("scp flink-1.12.2 hadoop02:/opt/apps/\nscp flink-1.12.2 hadoop03:/opt/apps/\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h5",{attrs:{id:"_2-1-5-启动集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-5-启动集群"}},[a._v("#")]),a._v(" 2.1.5 启动集群")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/start-cluster.sh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h5",{attrs:{id:"_2-1-6-查看web-ui界面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-6-查看web-ui界面"}},[a._v("#")]),a._v(" 2.1.6 查看Web UI界面")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/standalone-web.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"_2-2-flink独立高可用集群部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-flink独立高可用集群部署"}},[a._v("#")]),a._v(" 2.2 Flink独立高可用集群部署")]),a._v(" "),t("h5",{attrs:{id:"_2-2-1-解压缩文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-解压缩文件"}},[a._v("#")]),a._v(" 2.2.1 解压缩文件")]),a._v(" "),t("p",[a._v("将flink-1.12.2文件上传到指定目录并解压。")]),a._v(" "),t("h5",{attrs:{id:"_2-2-2-修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-修改配置文件"}},[a._v("#")]),a._v(" 2.2.2 修改配置文件")]),a._v(" "),t("p",[a._v("进入解压缩的路径的conf目录，修改flink-conf.yaml")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("jobmanager.rpc.address: hadoop01\n# 每个task可用的slot\ntaskmanager.numberOfTaskSlots: 3\n\nhigh-availability: zookeeper\nhigh-availability.storageDir: hdfs://supercluster/flink/standalone/ha/\nhigh-availability.zookeeper.quorum: hadoop01:2181,hadoop02:2181,hadoop03:2181\nhigh-availability.zookeeper.path.root: /flink-standalone\nhigh-availability.cluster-id: /flink-standalone-ha\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br")])]),t("h5",{attrs:{id:"_2-2-3-修改works文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-修改works文件"}},[a._v("#")]),a._v(" 2.2.3 修改works文件")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("hadoop01\nhadoop02\nhadoop03\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h5",{attrs:{id:"_2-2-4-修改masters文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-修改masters文件"}},[a._v("#")]),a._v(" 2.2.4 修改masters文件")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("hadoop01:8081\nhadoop02:8082\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h5",{attrs:{id:"_2-2-5-将flink分发到集群的每台机器中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-5-将flink分发到集群的每台机器中"}},[a._v("#")]),a._v(" 2.2.5 将flink分发到集群的每台机器中")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("scp flink-1.12.2 hadoop02:/opt/apps/\nscp flink-1.12.2 hadoop03:/opt/apps/\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h5",{attrs:{id:"_2-2-6-修改每台机器的环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-6-修改每台机器的环境变量"}},[a._v("#")]),a._v(" 2.2.6 修改每台机器的环境变量")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("export HADOOP_CLASSPATH=`hadoop classpath`\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h5",{attrs:{id:"_2-2-7-启动集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-启动集群"}},[a._v("#")]),a._v(" 2.2.7 启动集群")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("启动zookeeper和HDFS集群")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("启动Flink集群")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/start-cluster.sh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])])])])])]),a._v(" "),t("h5",{attrs:{id:"_2-2-8-使用zkcli查看谁是leader·"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-8-使用zkcli查看谁是leader·"}},[a._v("#")]),a._v(" 2.2.8 使用zkCli查看谁是leader·")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("get /flink-standalone/flink-standalone-ha/leader/rest_server_lock\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/standalone-hbleader.png",alt:""}})]),a._v(" "),t("h5",{attrs:{id:"_2-2-9-查看web-ui界面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-9-查看web-ui界面"}},[a._v("#")]),a._v(" 2.2.9 查看Web UI界面")]),a._v(" "),t("p",[a._v("从Web UI上无法区分谁是leader，都可以提交作业。")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/standalone-web.png",alt:""}})]),a._v(" "),t("h5",{attrs:{id:"_2-2-10-提交作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-10-提交作业"}},[a._v("#")]),a._v(" 2.2.10 提交作业")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/flink run \\\n-d \\\n-m hadoop02:8081 \\\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Java wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/standalone-submit.png",alt:""}})]),a._v(" "),t("h5",{attrs:{id:"_2-2-11-web-ui查看作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-11-web-ui查看作业"}},[a._v("#")]),a._v(" 2.2.11 Web UI查看作业")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/standalone-webui.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"_3-flink运行环境-yarn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-flink运行环境-yarn"}},[a._v("#")]),a._v(" 3. Flink运行环境_Yarn")]),a._v(" "),t("p",[a._v("独立部署（Standalone）模式是由Flink框架本身提供计算资源，无需其他框架提供资源。这种方式降低了和其他第三方资源框架的耦合性，独立性非常强。但是由于Flink主要是计算框架，而不是资源调度框架，所以本身资源调度并不是它的强项。")]),a._v(" "),t("p",[a._v("把Flink应用提交给Yarn的ResourceManager，Yarn的ResourceManager会申请容器从Yarn的NodeManager上面，Flink会创建JobManager和TaskManager在这些容器上面，Flink会根据运行在JobManager上的job的需要的slot数量动态分配TaskManager资源。")]),a._v(" "),t("h4",{attrs:{id:"_3-1-解压缩文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-解压缩文件"}},[a._v("#")]),a._v(" 3.1 解压缩文件")]),a._v(" "),t("p",[a._v("将flink-1.12.2.tgz文件上传到集群并解压缩，放置在指定位置。")]),a._v(" "),t("h4",{attrs:{id:"_3-2-配置环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-配置环境变量"}},[a._v("#")]),a._v(" 3.2 配置环境变量")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("HADOOP_CLASSPATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("hadoop classpath"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h4",{attrs:{id:"_3-3-修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-修改配置文件"}},[a._v("#")]),a._v(" 3.3 修改配置文件")]),a._v(" "),t("p",[a._v("如果需要每一个taskManager有更多的slot可用，需要修改flink-conf.yaml文件")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("taskmanager.numberOfTaskSlots: 3\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h4",{attrs:{id:"_3-4-启动hdfs和yarn集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-启动hdfs和yarn集群"}},[a._v("#")]),a._v(" 3.4 启动hdfs和yarn集群")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sbin/start-dfs.sh\nsbin/start-yarn.sh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h4",{attrs:{id:"_3-5-提交作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-提交作业"}},[a._v("#")]),a._v(" 3.5 提交作业")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/flink run \\\n-m yarn-cluster \\\n-yqu flink-xiaoer \\\n-d \\\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Java wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("ul",[t("li",[t("p",[a._v("-m：yarn提交模式")])]),a._v(" "),t("li",[t("div",{attrs:{align:"center"}},[t("font",{attrs:{color:"red",size:"4"}},[a._v("关注微信公众号《零基础学大数据》回复【Flink】领取全部PDF")])],1)]),a._v(" "),t("li",[t("p",[a._v("-d：提交作业后关闭客户端")])]),a._v(" "),t("li",[t("p",[a._v("-c：作业的主类以及jar包")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/yarn-cluster-submit.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"_3-6-yarn-web页面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-yarn-web页面"}},[a._v("#")]),a._v(" 3.6 Yarn Web页面")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://typora-image.test.upcdn.net/images/yarn-cluster-web.png",alt:""}})]),a._v(" "),t("h4",{attrs:{id:"_3-7-flink-on-yarn的三种部署模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-flink-on-yarn的三种部署模式"}},[a._v("#")]),a._v(" 3.7 Flink on Yarn的三种部署模式")]),a._v(" "),t("p",[a._v("Flink提供了yarn上运行的三种模式，分别为Session-Cluster，Application Mode和Per-Job-Cluster模式。更多详细的配置可以参考"),t("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.13/docs/deployment/config/",target:"_blank",rel:"noopener noreferrer"}},[a._v("配置文档"),t("OutboundLink")],1),a._v("。")]),a._v(" "),t("h5",{attrs:{id:"_3-7-1-session-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-1-session-cluster"}},[a._v("#")]),a._v(" 3.7.1 Session-Cluster")]),a._v(" "),t("p",[a._v("Session-Cluster模式需要先启动Flink集群，向yarn申请资源，资源申请到以后，永远保持不变。以后提交任务都向这里提交，这个Flink集群会常驻在yarn集群中，除非手工停止。")]),a._v(" "),t("p",[a._v("向Flink集群提交Job的时候，如果资源被用完了，则新的Job不能正常提交。")]),a._v(" "),t("p",[a._v("缺点：如果提交的作业中有长时间执行的大作业，占用了该Flink集群的所有的资源，则后续无法继续提交新的Job。Session-Cluster适合那些需要频繁提交的多个小Job，并且执行时间都不长。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/flink run \\\n-t yarn-session \\\n-Dyarn.application.id=application_xxx_yy \\\n-Dyarn.application.queue=flink-xiaoer \\\n-d \\\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Java wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("ul",[t("li",[t("p",[a._v("-t：yarn运行模式，可以指定yarn-session，也可以不指定，自动提交到yarn-session")])]),a._v(" "),t("li",[t("p",[a._v("-Dyarn.application.id：指定yarn-session，和-t同时出现")])]),a._v(" "),t("li",[t("p",[a._v("-Dyarn.application.queue：指定作业运行的yarn的队列")])]),a._v(" "),t("li",[t("p",[a._v("-d：提交作业后退出客户端")])]),a._v(" "),t("li",[t("p",[a._v("-c：指定作业运行的主类和jar包")])])]),a._v(" "),t("h5",{attrs:{id:"_3-7-2-per-job-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-2-per-job-cluster"}},[a._v("#")]),a._v(" 3.7.2 Per-Job-Cluster")]),a._v(" "),t("p",[a._v("一个Job会对应一个Flink集群，每提交一个作业会根据自身的情况，都会单独向yarn申请资源，直到作业执行完成，一个作业的失败并不会影响下一个作业的正常提交和执行。独享Dispatcher和ResourceManager，按需接受资源申请，适合大规模长时间运行的作业。对于资源方面，任务独占集群，隔离性最好。")]),a._v(" "),t("p",[a._v("每次提交作业都会创建一个新的Flink集群，任务之间互相独立，互不影响，方便管理。在任务执行完成之后创建的集群也会消失。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/flink run \\\n-t yarn-per-job \\\n-Dyarn.application.queue=flink-xiaoer \\\n-d \\\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Java wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/flink run \\\n-m yarn-cluster \\\n-yqu flink-xiaoer \\\n-d \\\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Java wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("h5",{attrs:{id:"_3-7-3-application-mode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-3-application-mode"}},[a._v("#")]),a._v(" 3.7.3 Application Mode")]),a._v(" "),t("p",[a._v("Application Mode会在Yarn上启动集群，应用jar包的main函数将会在JobManager上执行，只要应用程序Application执行结束，Flink集群会马上被关闭，也可以手动停止集群。资源的隔离性对于集群来说，Application之间隔离，Application内共享。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bin/flink run-application \\\n-t yarn-application \\\n-Dyarn.application.queue=flink-xiaoer \\\n-d \\\n-c com.yankee.day01.Flink03_WordCount_UnBounded_Java wordcount.jar\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("ul",[t("li",[t("p",[a._v("Per-Job-Cluster和Application Mode的区别")]),a._v(" "),t("p",[a._v("Per-Job-Cluster模式的main方法在客户端执行，Application Mode中的main方法在JobManager中执行，也就是说Application Mode模式将main方法提交到了集群执行。通过在JobManager中执行程序的main方法，Application模式可以节省很多提交应用所需的资源。同时就对于资源的隔离性来说，Per-Job-Cluster对资源的隔离性最好，Appcalition次之。")])])]),a._v(" "),t("h4",{attrs:{id:"_3-8-yarn模式高可用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-yarn模式高可用"}},[a._v("#")]),a._v(" 3.8 Yarn模式高可用")]),a._v(" "),t("p",[a._v("Yarn模式的高可用和Standalone的高可用原理不一样。Standalone模式中，同时启动多个JobManager，一个为leader，其他的是standby，当leader挂了，其他的一个才会成为leader。yarn的高可用是同时只启动一个JobManager，当这个JobManager挂了之后，yarn会再次启动一个，其实是利用yarn的重试次数来实现的高可用。")]),a._v(" "),t("h5",{attrs:{id:"_3-8-1-修改yarn-site-xml配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-1-修改yarn-site-xml配置文件"}},[a._v("#")]),a._v(" 3.8.1 修改yarn-site.xml配置文件")]),a._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("yarn.resourcemanager.am.max-attempts"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("4"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("h5",{attrs:{id:"_3-8-2-修改flink-conf-yaml配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-2-修改flink-conf-yaml配置文件"}},[a._v("#")]),a._v(" 3.8.2 修改flink-conf.yaml配置文件")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 这个配置要小于等于yarn-site中的配置")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("yarn.application-attempts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("high-availability")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" zookeeper\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("high-availability.storageDir")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" hdfs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//supercluster/flink/yarn/ha/\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("high-availability.zookeeper.quorum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" hadoop01"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2181")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("hadoop02"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2181")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("hadoop03"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2181")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("high-availability.zookeeper.path.root")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" /flink"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("yarn\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("high-availability.cluster-id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" /flink"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("yanr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("ha\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br")])]),t("div",{attrs:{align:"center"}},[t("font",{attrs:{color:"red",size:"4"}},[a._v("关注微信公众号《零基础学大数据》回复【Flink】领取全部PDF")])],1)])}),[],!1,null,null,null);s.default=e.exports}}]);