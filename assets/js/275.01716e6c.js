(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{777:function(e,s,a){"use strict";a.r(s);var t=a(21),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h4",{attrs:{id:"_1-准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-准备工作"}},[e._v("#")]),e._v(" 1. 准备工作")]),e._v(" "),a("p",[e._v("从官网下载Zeppelin的压缩包，"),a("a",{attrs:{href:"https://downloads.apache.org/zeppelin/zeppelin-0.10.0/zeppelin-0.10.0-bin-all.tgz",target:"_blank",rel:"noopener noreferrer"}},[e._v("下载地址"),a("OutboundLink")],1),e._v("。")]),e._v(" "),a("h4",{attrs:{id:"_2-zeppelin安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-zeppelin安装"}},[e._v("#")]),e._v(" 2. Zeppelin安装")]),e._v(" "),a("h5",{attrs:{id:"_2-1-解压zeppelin并创建软链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-解压zeppelin并创建软链接"}},[e._v("#")]),e._v(" 2.1 解压zeppelin并创建软链接")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("hadoop@cdh1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /opt/modules\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("hadoop@cdh1 modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" -zvxf zeppelin-0.10.0-bin-all.tgz\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("hadoop@cdh1 modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("ln")]),e._v(" -s zeppelin-0.10.0-bin-all zeppelin\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h5",{attrs:{id:"_2-2-配置环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-配置环境变量"}},[e._v("#")]),e._v(" 2.2 配置环境变量")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ZEPPELIN_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/opt/modules/zeppelin\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$PATH")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$ZEPPELIN_HOME")]),e._v("/bin\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h5",{attrs:{id:"_2-3-配置zeppelin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-配置zeppelin"}},[e._v("#")]),e._v(" 2.3 配置zeppelin")]),e._v(" "),a("p",[e._v("进入zeppelin的conf目录下，将"),a("code",[e._v("zeppelin-env.sh.template")]),e._v("修改为"),a("code",[e._v("zeppelin-env.sh")]),e._v("，并添加以下内容：")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/usr/java/jdk1.8.0_181-cloudera\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ZEPPELIN_ADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("cdh1\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ZEPPELIN_PORT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("9091")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h4",{attrs:{id:"_3-启动zeppelin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动zeppelin"}},[e._v("#")]),e._v(" 3. 启动zeppelin")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("hadoop@cdh1 modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" zeppelin\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("hadoop@cdh1 zeppelin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ bin/zeppelin-daemon.sh start\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("至此zeppelin已经安装完成，可以在浏览器上访问"),a("code",[e._v("cdh1:9091")]),e._v("打开zeppelin。")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/zeppelin-web.jpg",alt:""}})]),e._v(" "),a("h4",{attrs:{id:"_4-集成hive"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-集成hive"}},[e._v("#")]),e._v(" 4. 集成Hive")]),e._v(" "),a("p",[e._v('在Interpreters页面点击"+Create"创建一个新的解释器，其中Interpreters Name填写hive，Interpreters Group选择jdbc即可，其中必须改的配置是'),a("code",[e._v("default.url")]),e._v("和"),a("code",[e._v("default.driver")]),e._v("，分别是"),a("code",[e._v("jdbc:hive2://cdh1:10000")]),e._v("和"),a("code",[e._v("org.apache.hive.jdbc.HiveDriver")]),e._v("。")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-hive-setting.jpg",alt:""}})]),e._v(" "),a("p",[e._v("设置完成后，需要添加依赖的jar包，添加的jar包如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/opt/cloudera/parcels/CDH-6.3.2-1.cdh6.3.2.p0.1605554/jars/hive-jdbc-2.1.1-cdh6.3.2-standalone.jar\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-hive-jar.jpg",alt:""}})]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-hive-sql.jpg",alt:""}})]),e._v(" "),a("h4",{attrs:{id:"_5-集成hbase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-集成hbase"}},[e._v("#")]),e._v(" 5. 集成HBase")]),e._v(" "),a("p",[e._v("Zeppelin-0.10.0以及集成了HBase，需要在"),a("code",[e._v("zeppelin-env.sh")]),e._v("中设置"),a("code",[e._v("HBASE_HOME")]),e._v("和 "),a("code",[e._v("HBASE_CONF_DIR")]),e._v("环境变量。")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("HBASE_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/opt/cloudera/parcels/CDH/lib/hbase\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("HBASE_CONF_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/opt/cloudera/parcels/CDH/lib/hbase/conf\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-hbase-setting.jpg",alt:""}})]),e._v(" "),a("p",[e._v("设置好环境变量之后，修改Interpreter Name为hbase的"),a("code",[e._v("hbase.home")]),e._v("和"),a("code",[e._v("hbase.ruby.sources")]),e._v("这两个参数。同时还要引入相关的hbase的jar包依赖。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/opt/cloudera/parcels/CDH/lib/hbase/lib/hbase-client-2.1.0-cdh6.3.2.jar\n/opt/cloudera/parcels/CDH/lib/hbase/lib/hbase-common-2.1.0-cdh6.3.2.jar\n/opt/cloudera/parcels/CDH/lib/hbase/lib/hbase-protocol-2.1.0-cdh6.3.2.jar\n/opt/cloudera/parcels/CDH/lib/hbase/lib/commons-lang3-3.7.jar\n/opt/cloudera/parcels/CDH/lib/hbase/lib/hbase-shaded-protobuf-2.2.1.jar\n/opt/cloudera/parcels/CDH/lib/hbase/lib/hbase-shaded-miscellaneous-2.2.1.jar\n/opt/cloudera/parcels/CDH/lib/hbase/lib/hbase-protocol-shaded-2.1.0-cdh6.3.2.jar\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("p",[a("img",{attrs:{src:"images/",alt:""}})]),e._v(" "),a("h4",{attrs:{id:"_6-集成spark"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-集成spark"}},[e._v("#")]),e._v(" 6. 集成spark")]),e._v(" "),a("p",[e._v("Zeppelin-0.10.0已经集成了Spark，需要在"),a("code",[e._v("zeppelin-env.sh")]),e._v("中设置"),a("code",[e._v("SPARK_HOME")]),e._v("和"),a("code",[e._v("SPARK_CONF_DIR")]),e._v("环境变量。")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SPARK_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/opt/cloudera/parcels/CDH/lib/spark\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SPARK_CONF_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/opt/cloudera/parcels/CDH/lib/spark/conf\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("设置zeppelin提交的sql以yarn-cluster或者yarn-client模式运行，需要修改Interpreter Name为spark的"),a("code",[e._v("spark.master")]),e._v("和"),a("code",[e._v("spark.submit.deployMode")]),e._v("这两个参数。")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-spark-sql.jpg",alt:""}}),e._v(")")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-spark-sql.jpg",alt:""}})]),e._v(" "),a("h4",{attrs:{id:"_7-集成flink"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-集成flink"}},[e._v("#")]),e._v(" 7. 集成Flink")]),e._v(" "),a("p",[e._v("Zeppelin-0.10.0已经集成了Flink，设置Flink on Yarn模式需要"),a("code",[e._v("zeppelin-env.sh")]),e._v("中设置"),a("code",[e._v("USE_HADOOP")]),e._v("和"),a("code",[e._v("HADOOP_CONF_DIR")]),e._v("环境变量。")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("USE_HADOOP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("HADOOP_CONF_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/opt/cloudera/parcels/CDH/lib/hadoop/etc/hadoop\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("设置zeppelin提交的sql以类似yarn-per-job模式运行（这种模式其实是每个note对应一个flink-session），需要修改Interpreter Name为flink的Interpreter Binding模式为"),a("code",[e._v("isolated per note")]),e._v("，同时也要修改"),a("code",[e._v("FLINK_HOME")]),e._v("、"),a("code",[e._v("HADOOP_CONF_DIR")]),e._v("、"),a("code",[e._v("flink.execution.mode")]),e._v("、"),a("code",[e._v("flink.yarn.appName")]),e._v("和"),a("code",[e._v("flink.yarn.queue")]),e._v("等参数。")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-flink-setting.jpg",alt:""}})]),e._v(" "),a("p",[e._v("打开Flink Interpreter的Streaming ETL对应的notebook，运行sql之前需要先运行"),a("code",[e._v("%flink.conf")]),e._v("中的内容，这个中的参数支持Flink的所有配置参数，具体可以参考"),a("a",{attrs:{href:"https://nightlies.apache.org/flink/flink-docs-release-1.13/docs/deployment/config/",target:"_blank",rel:"noopener noreferrer"}},[e._v("官网"),a("OutboundLink")],1),e._v("。")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-flink-sql.jpg",alt:""}})]),e._v(" "),a("p",[e._v("如果需要访问hive数据，以及使用HiveCatalog管理FlinkSQL的元数据，则还需要与Hive集成。修改Flink的Interpreter中的"),a("code",[e._v("HIVE_CONF_DIR")]),e._v("、"),a("code",[e._v("zeppelin.flink.enableHive")]),e._v("和"),a("code",[e._v("zeppelin.flink.hive.version")]),e._v("等参数，同时还需要将hive相关的jar包依赖也复制到"),a("code",[e._v("$FLINK_HOME/lib")]),e._v("目录下。")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-flink-setting-hive.jpg",alt:""}})]),e._v(" "),a("p",[e._v("相关的依赖jar包如下所示：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("flink-connector-hive_2.12-1.13.6.jar\nflink-hadoop-compatibility_2.12-1.13.6.jar\nhive-exec-2.1.1-cdh6.3.2.jar\nlibfb303-0.9.3.jar\nhadoop-mapreduce-client-core-3.0.0-cdh6.3.2.jar\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://yanko.test.upcdn.net/images/interpreter-flink-sql-hive.jpg",alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);